<footer class="site-footer">
  <div class="container footer-inner">
    <div class="footer-meta">
      <p>Â© {{ site.time | date: '%Y' }} {{ site.title }}. All rights reserved.</p>
    </div>
    <nav aria-label="Footer">
      <ul>
        {% assign current_lang = page.lang | default: site.lang | default: 'zh' %}
        {% assign nav = site.data.nav[current_lang] %}
        {% for item in nav.footer %}
          <li><a href="{{ item.url | relative_url }}">{{ item.label }}</a></li>
        {% endfor %}
      </ul>
    </nav>
  </div>
</footer>
<script>
(function(){
  const wraps = document.querySelectorAll('.hscroll-wrap.one');
  if(!wraps.length) return;
  wraps.forEach(wrap=>{
    const scroller = wrap.querySelector('.hscroll.one');
    const dots = Array.from(wrap.querySelectorAll('.dots .dot'));
    const cards = Array.from(scroller?.querySelectorAll('.hcard') || []);
    if(!scroller || !dots.length || !cards.length) return;
    const interactiveDots = dots.filter(d=>!d.disabled && !d.hasAttribute('aria-hidden'));
    const pageSize = Math.max(1, Math.round(cards.length / Math.max(1, interactiveDots.length || 3)));
    const maxGroup = Math.max(0, interactiveDots.length - 1);
    function scrollToGroup(g){
      const idx = Math.min(cards.length - 1, g * pageSize);
      const card = cards[idx];
      if(card){ card.scrollIntoView({behavior:'smooth', inline:'center', block:'nearest'}); activate(g); }
    }
    function activeGroup(){
      const mid = scroller.getBoundingClientRect().left + scroller.clientWidth/2;
      let activeIdx = 0, minDist = Infinity;
      cards.forEach((el, i)=>{
        const rect = el.getBoundingClientRect();
        const center = rect.left + rect.width/2;
        const dist = Math.abs(center - mid);
        if(dist < minDist){ minDist = dist; activeIdx = i; }
      });
      return Math.min(maxGroup, Math.floor(activeIdx / pageSize));
    }
    function activate(g){
      dots.forEach((d,i)=>{
        d.classList.toggle('active', i===g);
        if(!d.hasAttribute('aria-hidden')) d.disabled = (i !== g && interactiveDots.length > 1) ? false : d.disabled;
      });
    }
    dots.forEach((btn,i)=>{ if(!btn.disabled){ btn.addEventListener('click', ()=>scrollToGroup(i)); } });
    const onScroll = ()=> activate(activeGroup());
    scroller.addEventListener('scroll', onScroll, {passive:true});
    window.addEventListener('resize', onScroll);
    activate(0);
  });
})();
</script>
<script>
(function(){
  const mql = window.matchMedia('(max-width: 900px)');
  function setup(){
    document.querySelectorAll('[data-nav-item]').forEach(item=>{
      const caret = item.querySelector('[data-nav-caret]');
      const dropdown = item.querySelector('.dropdown');
      if(!caret || !dropdown) return;
      // mobile: click to toggle
      caret.onclick = (e)=>{
        if(mql.matches){
          e.preventDefault();
          const open = item.classList.contains('open');
          document.querySelectorAll('.nav-item.has-children.open').forEach(i=>i.classList.remove('open'));
          if(!open) item.classList.add('open');
          caret.setAttribute('aria-expanded', String(!open));
        }
      };
    });
  }
  document.addEventListener('keydown', (e)=>{
    if(e.key === 'Escape'){
      document.querySelectorAll('.nav-item.has-children.open').forEach(i=>i.classList.remove('open'));
    }
  });
  setup();
})();
</script> 
